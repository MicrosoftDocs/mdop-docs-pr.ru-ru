---
title: Настройка сервера для разрешения делегирования
description: Настройка сервера для разрешения делегирования
author: dansimp
ms.assetid: d8d11588-17c0-4bcb-a7e6-86b5e4ba7e1c
ms.reviewer: ''
manager: dansimp
ms.author: dansimp
ms.pagetype: mdop, appcompat, virtualization
ms.mktglfcycl: deploy
ms.sitesec: library
ms.prod: w10
ms.date: 06/16/2016
ms.openlocfilehash: 7164b3046671853216b870d68e651fed4fd84695
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/26/2020
ms.locfileid: "10817749"
---
# Настройка сервера для разрешения делегирования


При установке серверного программного обеспечения Microsoft Application Virtualization (App-V) Management Server вы можете установить его с помощью архитектуры распределенной системы. Если вы установили консоль, веб-службу управления и базу данных на разных компьютерах, необходимо настроить сервер служб IIS таким образом, чтобы он был доверен для делегирования. Это необходимо, поскольку веб-служба управления пытается подключиться к хранилищу данных App-V с помощью учетных данных администратора App-V, использующего консоль. Сервер базы данных, на котором установлен хранилище данных, не будет принимать учетные данные администратора сервера IIS, если только сервер IIS не настроен для делегирования, поэтому веб-служба управления не сможет подключаться к хранилищу данных App-V.

**Примечание**  Если вы установили программное обеспечение сервера управления App-V на одном сервере и размещаете хранилище данных на отдельном сервере, существует ситуация, когда необходимо настроить сервер для делегирования, даже если веб-служба управления и консоль управления находятся на одном и том же сервере. Эта ситуация возникает, если вам нужно подключиться к веб-службе управления на консоли с помощью параметра **использовать альтернативные учетные данные** .

 

Тип делегирования, который можно использовать, зависит от функционального уровня домена, настроенного в инфраструктуре доменных служб Active Directory (ADDS). В следующей таблице перечислены типы делегирования, которые можно настроить для каждого функционального уровня для App-V. Подробные инструкции следуют за таблицей.

<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Функциональный уровень домена</th>
<th align="left">Доступные уровни делегирования</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><p>Windows 2000 Native</p></td>
<td align="left"><ul>
<li><p>Без делегирования (по умолчанию)</p></li>
<li><p>Неограниченное делегирование</p></li>
</ul></td>
</tr>
<tr class="even">
<td align="left"><p>Windows Server 2003, Windows Server 2008 или Windows Server 2008 R2</p></td>
<td align="left"><ul>
<li><p>Без делегирования (по умолчанию)</p></li>
<li><p>Неограниченное делегирование ¹</p></li>
<li><p>Ограниченное делегирование (использование протоколов Kerberos)</p></li>
<li><p>Ограниченное делегирование (использование любого протокола проверки подлинности) ¹</p></li>
</ul></td>
</tr>
</tbody>
</table>

 

¹ не рекомендуется.

## Настройка неограниченного делегирования при использовании режима работы домена в Windows 2000 Native


На контроллере домена вашего веб-сервера выполните указанные ниже действия.

****

1.  Нажмите кнопку **Пуск**и выберите пункт **средства администрирования**, а затем — **Пользователи и компьютеры Active Directory**.

2.  Разверните домен, а затем разверните папку компьютеры.

3.  На правой панели щелкните правой кнопкой мыши имя компьютера для веб-сервера и выберите пункт **Свойства**.

4.  Убедитесь, что на вкладке **Общие** установлен флажок **доверенный компьютер для делегирования** .

5.  Нажмите кнопку **ОК**.

## Настройка неограниченного делегирования при установленном функциональном уровне домена Windows Server 2003, Windows Server 2008 или Windows Server 2008 R2


На контроллере домена вашего веб-сервера выполните указанные ниже действия.

****

1.  Нажмите кнопку **Пуск**и выберите пункт **Администрирование**, а затем — **Пользователи и компьютеры Active Directory**.

2.  Разверните домен и разверните папку компьютеры.

3.  На правой панели щелкните правой кнопкой мыши имя компьютера для веб-сервера, выберите пункт **Свойства**, а затем откройте вкладку **Делегирование** .

4.  Щелкните, чтобы выбрать параметр **доверять этому компьютеру для делегирования служб (только Kerberos)**.

5.  Нажмите кнопку **ОК**.

## Настройка ограниченного делегирования при использовании функционального уровня домена Windows Server 2003, Windows Server 2008 или Windows Server 2008 R2


На контроллере домена вашего веб-сервера выполните указанные ниже действия.

****

1.  Нажмите кнопку **Пуск**и выберите пункт **Администрирование**, а затем — **Пользователи и компьютеры Active Directory**.

2.  Разверните домен, а затем разверните папку компьютеры.

3.  На правой панели щелкните правой кнопкой мыши имя компьютера для веб-сервера, выберите пункт **Свойства**, а затем откройте вкладку **Делегирование** .

4.  Выберите этот пункт, чтобы сделать **этот компьютер доверенным для делегирования указанных служб**.

5.  Убедитесь, что установлен флажок **использовать только Kerberos** , и нажмите кнопку **ОК**.

6.  Нажмите кнопку **Добавить** . В диалоговом окне **Добавление служб** выберите пункт **Пользователи или компьютеры**, найдите или введите имя сервера Microsoft SQL Server, на котором находится хранилище данных App-V, и получите учетные данные пользователей из IIS. Нажмите кнопку **ОК**.

7.  В списке **Доступные службы** выберите службу MSSQLSvc, которая содержит номер порта, на котором Microsoft SQL Server принимает соединения для базы данных App-V (порт по умолчанию — 1433). Нажмите кнопку **ОК**.

### Дополнительные действия по настройке служб IIS 7 для ограниченного делегирования

Если вы используете веб-службу управления на сервере IIS 7, необходимо выполнить описанные ниже действия, чтобы установить для переменной IIS 7 *UseAppPoolCredentials* значение true.

1.  Откройте окно командной строки с повышенными привилегиями. Чтобы открыть окно командной строки с повышенными привилегиями, нажмите кнопку **Пуск**, выберите **все программы**, затем **стандартные**, щелкните правой кнопкой мыши **Командная строка**и выберите пункт **Запуск от имени администратора**.

2.  Переход к%WINDIR%\\system32\\inetsrv.

3.  Введите **appcmd.exe set config-Section: System. Web Server/Security/Authentication/windowsAuthentication-useAppPoolCredentials: true**, а затем нажмите клавишу ВВОД.

 

 





