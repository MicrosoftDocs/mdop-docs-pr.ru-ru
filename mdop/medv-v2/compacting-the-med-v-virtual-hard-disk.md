---
title: Сжатие виртуального жесткого диска MED-V
description: Сжатие виртуального жесткого диска MED-V
author: dansimp
ms.assetid: 5e6122d1-9847-4b33-adab-594919eec3c5
ms.reviewer: ''
manager: dansimp
ms.author: dansimp
ms.pagetype: mdop, virtualization
ms.mktglfcycl: deploy
ms.sitesec: library
ms.prod: w10
ms.date: 06/16/2016
ms.openlocfilehash: f71aefb1e4e901078b4d0a421065b7bd5acdf0ee
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/26/2020
ms.locfileid: "10823279"
---
# Сжатие виртуального жесткого диска MED-V


Несмотря на то что этот параметр необязателен, вы можете сжать виртуальный жесткий диск (VHD), чтобы освободить пустое место на диске, а затем уменьшить размер VHD перед настройкой образа Virtual PC для Windows.

**Важно!**  Прежде чем продолжить, создайте резервную копию образа Windows XP.

 

**Подготовка виртуального жесткого диска**

1.  Откройте образ Windows XP.

    Нажмите кнопку **Пуск**, выберите **все программы**, а затем — **Virtual PC**, **Windows Virtual PC**, а затем дважды щелкните значок Windows XP.

2.  Очистите кэш DLL.

    1.  В командной строке виртуальной машины введите **sfc/CacheSize = 1**.

    2.  Перезапустите виртуальную машину.

    3.  В командной строке виртуальной машины введите **sfc/purgecache**.

3.  Удалите ненужные файлы, такие как программы удаления, временные файлы, файлы журнала, файлы страниц, общие папки и т. д.

4.  Отключите восстановление системы. Вы также можете указать этот шаг в файле Sysprep. INF.

    1.  На **панели управления**дважды щелкните значок **система**и выберите вкладку **Восстановление системы** .

    2.  Выберите **Отключить восстановление системы**, а затем нажмите кнопку **ОК**.

5.  Настройка максимального размера журнала событий и удаление всех событий.

    1.  Откройте средство просмотра событий.

        Нажмите кнопку **Пуск**, выберите пункт **Панель управления**, дважды щелкните элемент **Администрирование**, а затем дважды щелкните **Просмотр событий**.

    2.  Щелкните правой кнопкой мыши **приложение**и выберите пункт **свойства**.

    3.  В области **Размер журнала** установите для **максимального размера журнала** значение 512 КБ и выберите параметр **Затирать события по мере необходимости**.

    4.  Нажмите **Очистить журнал**. В появившемся диалоговом окне " **Просмотр событий** " нажмите кнопку **нет**.

    5.  В окне " **Свойства** " нажмите кнопку **ОК**.

    6.  Повторите действия от a до e для журналов **безопасности** и **системы** .

6.  Запустите средство очистки диска.

    Нажмите кнопку **Пуск**, **выберите все программы**, затем **стандартные**, **выберите пункт Служебные**и нажмите кнопку **Очистка диска**.

7.  Настройте файл на странице в соответствии с вашими требованиями для вашего приложения.

    1.  На **панели управления**дважды щелкните значок **система**и перейдите на вкладку **Дополнительно** .

    2.  В области **Performance (производительность** ) нажмите кнопку **Параметры**.

    3.  В области **Виртуальная память** нажмите кнопку **изменить**.

    4.  Настройка параметров файла подкачки.

8.  Завершите работу с изображением Windows XP.

**Дефрагментация и предварительное сжатие виртуального жесткого диска**

1.  На главном компьютере под управлением Windows 7 на **панели управления** выберите элемент **Администрирование**, дважды щелкните **Управление компьютером**, а затем — **Управление дисками**.

2.  С помощью консоли управления дисками Прикрепите (Подключите) виртуальный жесткий диск и Дефрагментация диска.

3.  С помощью средства извлечения ISO-файлов извлеките файлы из файла recompact. ISO, расположенного в папке \\Program Files\\Windows Virtual PC\\Integration Components.

4.  Используйте программу precompact.exe для сжатия виртуального жесткого диска Windows XP.

5.  С помощью консоли управления дисками отключите виртуальный жесткий диск.

**Сжатие виртуального жесткого диска**

1.  Откройте Windows Virtual PC.

    Нажмите кнопку **Пуск**, выберите **все программы**, а затем — **Virtual PC**и **Windows Virtual PC**.

2.  Щелкните правой кнопкой мыши образ Windows XP и выберите пункт **Параметры**.

3.  Выберите **жесткий диск** , соответствующий вашему образу Windows XP, и нажмите кнопку **изменить**.

4.  Выберите **Сжатие виртуального жесткого диска**.

5.  Нажмите кнопку **Сжать** и нажмите кнопку **ОК**.

Создайте резервную копию сжатого виртуального жесткого диска.

## Статьи по теме


[Настройка образа Windows Virtual PC для MED-V](configuring-a-windows-virtual-pc-image-for-med-v.md)

[Технический справочник по MED-V](technical-reference-for-med-v.md)

 

 





