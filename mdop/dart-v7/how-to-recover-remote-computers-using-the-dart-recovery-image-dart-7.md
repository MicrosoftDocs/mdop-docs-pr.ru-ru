---
title: Восстановление удаленных компьютеров с помощью образа для восстановления DaRT
description: Восстановление удаленных компьютеров с помощью образа для восстановления DaRT
author: dansimp
ms.assetid: 66bc45fb-dc40-4d47-b583-5bb1ff5c97a7
ms.reviewer: ''
manager: dansimp
ms.author: dansimp
ms.pagetype: mdop
ms.mktglfcycl: support
ms.sitesec: library
ms.prod: w10
ms.date: 08/30/2016
ms.openlocfilehash: 885ab1d1cf8f51dc4fd4613e41a20a2525ea7d6d
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/26/2020
ms.locfileid: "10822792"
---
# Восстановление удаленных компьютеров с помощью образа для восстановления DaRT


Функция удаленного подключения в наборе средств диагностики и восстановления Microsoft (DaRT) 7 позволяет ИТ-администратору запускать инструменты DaRT удаленно на компьютере с конечным пользователем. После того как конечные пользователи предоставляют определенную информацию (или специалист службы поддержки, работающий на компьютере пользователя), он может управлять компьютером конечного пользователя и запускать необходимые инструменты DaRT удаленно.

**Важно.**  
Два компьютера, на которых установлено удаленное подключение, должны входить в одну и ту же сеть.



**Восстановление удаленного компьютера с помощью DaRT**

1.  Загрузите компьютер с конечным пользователем, используя изображение для восстановления DaRT.

    Вы обычно используете один из указанных ниже способов для загрузки DaRT для восстановления удаленного компьютера, в зависимости от того, как вы разворачиваете изображение для восстановления DaRT. Дополнительные сведения о развертывании изображения для восстановления DaRT можно найти [в разделе Развертывание образа восстановления dart 7,0](deploying-the-dart-70-recovery-image-dart-7.md).

    -   Загрузите элемент DaRT из раздела восстановления на компьютере с ошибкой.

    -   Загрузите элемент DaRT из удаленной секции в сети.

    Сведения о преимуществах и недостатках каждого из этих методов можно найти в разделе [Планирование сохранения и развертывания образа восстановления DaRT 7,0](planning-how-to-save-and-deploy-the-dart-70-recovery-image.md).

    Какой бы метод вы использовали для загрузки в DaRT, необходимо включить загрузочное устройство в BIOS для варианта загрузки или параметров, которые должны быть доступны для конечного пользователя.

    **Примечание.**  
    Настройка BIOS является уникальной в зависимости от типа жесткого диска, сетевых адаптеров и другого оборудования, которое используется в Организации.



2.  При загрузке на изображение для восстановления DaRT на экране появится диалоговое окно " **NetStart** ". Вам будет предложено указать, нужно ли инициализировать сетевые службы. Если нажать кнопку **Да**, предполагается, что в сети есть DHCP-сервер и сделана попытка получить IP-адрес с сервера. Если в сети вместо DHCP используются статические IP-адреса, вы можете позже воспользоваться средством **настройки TCP/IP** в DART, чтобы указать статический IP-адрес.

    Чтобы пропустить процесс инициализации сети, нажмите кнопку **нет**.

3.  В диалоговом окне "инициализация сети" появится вопрос о том, нужно ли переназначить буквы дисков. При запуске Windows Online системный том обычно отображается на диске C. Однако при запуске Windows в автономном режиме в среде WinRE исходный системный том может быть сопоставлен с другим диском, и это может привести к путанице. Если вы решили выполнить повторное сопоставление, DaRT попытается сопоставить буквы для автономного диска с буквами, заданными в сети. Повторное сопоставление выполняется только в том случае, если в процессе запуска выбрана автономная операционная система.

4.  В диалоговом окне Изменение сопоставления в диалоговом окне **Параметры восстановления системы** появляется запрос на выбор раскладки клавиатуры. Затем отображается корневой каталог системы, вариант установленной операционной системы и размер раздела. Если вы не видите указанную в списке операционную систему и подозреваете, что причиной сбоя является нехватка драйверов, нажмите **загрузить драйверы** , чтобы загрузить подозрительные драйверы. В этом случае вам будет предложено вставить установочный носитель для устройства и выбрать драйвер. Выберите установку, которую вы хотите восстановить или диагностировать, и нажмите кнопку **Далее**.

    **Примечание.**  
    Если среда восстановления Windows (WinRE) обнаруживает или подозреваете, что Windows 7 не запускается надлежащим образом в последний раз, программа **восстановления запуска** может начать выполняться автоматически. Сведения об этой ситуации, в том числе о том, как ее устранить, приведены в разделе [Устранение неполадок DaRT 7,0](troubleshooting-dart-70-new-ia.md).



~~~
If any of the registry hives are corrupted or missing, Registry Editor, and several other DaRT utilities, will have limited functionality. If no operating system is selected, some tools will not be available.

The **System Recovery Options** window appears and lists various recovery tools.
~~~

5. В окне **Параметры восстановления системы** выберите **набор средств диагностики и восстановления Microsoft** , чтобы открыть окно **инструментов Диагностика и восстановление** .

6. В окне **Инструменты Диагностика и восстановление** щелкните **удаленное подключение** , чтобы открыть окно **удаленного подключения DART** . Если вам будет предложено предоставить службе поддержки удаленный доступ, нажмите кнопку **ОК**.

   Откроется окно с удаленным подключением DaRT, в котором отображается номер билета, IP-адрес и сведения о порте.

7. На компьютере агента службы поддержки откройте **средство просмотра удаленных подключений DART**.

   Нажмите кнопку **Пуск**, выберите **все программы**, а затем — **Microsoft DaRT 7**, а затем — **средство просмотра удаленных подключений для DART**.

8. В окне **удаленного подключения DART** введите необходимый билет, IP-адрес и сведения о порте.

   **Примечание.**  
   Эти сведения создаются на компьютере пользователя и должны быть предоставлены конечным пользователем. Возможно, вы можете выбрать несколько IP-адресов, в зависимости от того, сколько доступно на компьютере конечного пользователя.



9. Нажмите кнопку **Подключить**.

Теперь ИТ-администратор может управлять компьютером конечного пользователя и удаленно запускать инструменты DaRT.

**Примечание.**  
Файл с именем inv32.xml и содержит сведения об удаленном подключении, такие как номер порта и IP-адрес. По умолчанию файл обычно размещается по адресу%windir%\\system32.



**Настройка процесса удаленного подключения**

1. Вы можете настроить процесс удаленного подключения, изменив файл winpeshl.ini. Дополнительные сведения о том, как изменить winpeshl.ini файл, можно найти в разделе [Winpeshl.ini файлы](https://go.microsoft.com/fwlink/?LinkId=219413).

   Укажите указанные ниже команды и параметры, чтобы настроить способ установки удаленного подключения для конечного пользователя.

   <table>
   <colgroup>
   <col width="33%" />
   <col width="33%" />
   <col width="33%" />
   </colgroup>
   <thead>
   <tr class="header">
   <th align="left">Команда</th>
   <th align="left">Параметр</th>
   <th align="left">Описание</th>
   </tr>
   </thead>
   <tbody>
   <tr class="odd">
   <td align="left"><p><strong>RemoteRecovery.exe</strong></p></td>
   <td align="left"><p>-е сообщение</p></td>
   <td align="left"><p>Указывает, что запрос подтверждения не отображается. <strong>Удаленное соединение </strong> продолжится так, как будто конечный пользователь &quot; ответил &quot; на запрос подтверждения.</p></td>
   </tr>
   <tr class="even">
   <td align="left"><p><strong>WaitForConnection.exe</strong></p></td>
   <td align="left"><p>нет</p></td>
   <td align="left"><p>Предотвращает продолжение настраиваемого сценария, пока <strong> </strong> не будет запущено удаленное подключение или не будет установлено действующее соединение с конечным компьютером пользователя.</p>
   <div class="alert">
   <strong>Важно.</strong><br/><p>Эта команда не выполняет никаких функций, если она указана независимо друг от друга. Он должен быть указан в сценарии для правильной работы.</p>
   </div>
   <div>

   </div></td>
   </tr>
   </tbody>
   </table>



2. Ниже приведен пример файла winpeshl.ini, который настроен таким образом, чтобы открыть средство **удаленного подключения** , как только вы попытаетесь загрузить DART:

   ```ini
   [LaunchApps]
   "%windir%\system32\netstart.exe -network -remount"
   "cmd /C start %windir%\system32\RemoteRecovery.exe -nomessage"
   "%windir%\system32\WaitForConnection.exe"
   "%SYSTEMDRIVE%\sources\recovery\recenv.exe"
   ```

**Запуск средства просмотра удаленных подключений из командной строки**

1.  Вы можете запустить **средство просмотра удаленных подключений DART** в командной строке, указав команду **DartRemoteViewer.exe** и используя указанные ниже параметры.

    <table>
    <colgroup>
    <col width="50%" />
    <col width="50%" />
    </colgroup>
    <thead>
    <tr class="header">
    <th align="left">Параметр</th>
    <th align="left">Описание</th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td align="left"><p>-билета = &lt; <em> ticketnumber</em>&gt;</p></td>
    <td align="left"><p>Где &lt; <em> ticketnumber </em> &gt; — номер билета, включая тире, которое генерируется удаленным соединением.</p></td>
    </tr>
    <tr class="even">
    <td align="left"><p>-IPAddress = &lt; <em> IPAddress</em>&gt;</p></td>
    <td align="left"><p>&lt; <em> </em> &gt; IP-адрес, который генерируется удаленным подключением, где IPAddress.</p></td>
    </tr>
    <tr class="odd">
    <td align="left"><p>-Port = &lt; <em> Port (порт)</em>&gt;</p></td>
    <td align="left"><p>Если &lt; <em> Port (порт) </em> &gt; — порт, соответствующий указанному IP-адресу.</p></td>
    </tr>
    </tbody>
    </table>



~~~
**Note**  
The variables for these parameters are created on the end-user computer and must be provided by the end user.
~~~



2. Если указаны все три параметра и данные являются допустимыми, при запуске программы немедленно исключается соединение. Если какой – либо параметр является недопустимым, программа запускается так, как если бы не были указаны параметры.

## Статьи по теме


[Восстановление компьютеров с помощью DaRT 7.0](recovering-computers-using-dart-70-dart-7.md)









